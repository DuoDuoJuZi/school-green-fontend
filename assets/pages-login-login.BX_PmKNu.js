import{r as l,c as e,w as a,i as s,o as u,a as t,b as o,t as c,k as d,h as n,F as i,B as r,q as p,u as f,y as v,T as _,d as m,e as h,I as g,U as k,H as y}from"./index-CuaaJPDA.js";import{_ as V}from"./logo.rRFpfryy.js";import{r as b}from"./request.CEomxEkn.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=x({__name:"login",setup(x){const w=l(!1),C=l(""),j=l(""),I=l(""),T=l(!1),U=()=>{w.value=!w.value,C.value="",j.value="",I.value="",T.value=!1},q=()=>{T.value=!T.value},E=async()=>{if(C.value&&j.value)if(w.value&&j.value!==I.value)r({title:"两次密码输入不一致",icon:"none"});else if(T.value){p({title:w.value?"注册中...":"登录中..."});try{const l=w.value?"/auth/register":"/auth/login",e=await b({url:l,method:"POST",data:{username:C.value,password:j.value}});f(),w.value?(r({title:"注册成功，请登录",icon:"success"}),setTimeout((()=>{U()}),1500)):(console.log("登录响应数据:",e),e.data&&e.data.token?(v("token",e.data.token),v("userInfo",e.data.userInfo),r({title:"登录成功",icon:"success"}),setTimeout((()=>{_({url:"/pages/about/about"})}),1500)):r({title:"登录数据异常",icon:"none"}))}catch(l){f()}}else r({title:"请先同意用户协议",icon:"none"});else r({title:"请输入用户名和密码",icon:"none"})};return(l,r)=>{const p=m,f=h,v=s,_=g,b=k,x=y;return u(),e(v,{class:"page"},{default:a((()=>[t(v,{class:"logo-area"},{default:a((()=>[t(p,{src:V,mode:"widthFix",class:"logo"}),t(f,{class:"app-name"},{default:a((()=>[o("校园绿动")])),_:1}),t(f,{class:"slogan"},{default:a((()=>[o(c(w.value?"创建您的环保账号":"开启你的绿色校园生活"),1)])),_:1})])),_:1}),t(v,{class:"form-area"},{default:a((()=>[t(v,{class:"input-group"},{default:a((()=>[t(f,{class:"label"},{default:a((()=>[o("用户名 / 学号")])),_:1}),t(_,{class:"input",type:"text",modelValue:C.value,"onUpdate:modelValue":r[0]||(r[0]=l=>C.value=l),placeholder:"请输入您的昵称或学号","placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1}),t(v,{class:"input-group"},{default:a((()=>[t(f,{class:"label"},{default:a((()=>[o("密码")])),_:1}),t(_,{class:"input",type:"password",modelValue:j.value,"onUpdate:modelValue":r[1]||(r[1]=l=>j.value=l),placeholder:"请输入密码","placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1}),w.value?(u(),e(v,{key:0,class:"input-group"},{default:a((()=>[t(f,{class:"label"},{default:a((()=>[o("确认密码")])),_:1}),t(_,{class:"input",type:"password",modelValue:I.value,"onUpdate:modelValue":r[2]||(r[2]=l=>I.value=l),placeholder:"请再次输入密码","placeholder-class":"placeholder"},null,8,["modelValue"])])),_:1})):d("",!0),t(v,{class:"agreement-box"},{default:a((()=>[t(b,{checked:T.value,onClick:q,color:"#3A7E5E",style:{transform:"scale(0.7)"}},null,8,["checked"]),t(v,{class:"agreement-text"},{default:a((()=>[t(f,{onClick:q},{default:a((()=>[o("我已阅读并同意")])),_:1}),t(f,{class:"link"},{default:a((()=>[o("《用户协议》")])),_:1}),t(f,null,{default:a((()=>[o("与")])),_:1}),t(f,{class:"link"},{default:a((()=>[o("《隐私政策》")])),_:1})])),_:1})])),_:1}),t(x,{class:"login-btn",onClick:E},{default:a((()=>[o(c(w.value?"立即注册":"立即登录"),1)])),_:1}),t(v,{class:"links"},{default:a((()=>[w.value?(u(),n(i,{key:1},[t(f,null,{default:a((()=>[o("已有账号？")])),_:1}),t(f,{class:"link-highlight",onClick:U},{default:a((()=>[o("直接登录")])),_:1})],64)):(u(),n(i,{key:0},[t(f,null,{default:a((()=>[o("忘记密码")])),_:1}),t(f,{class:"divider"},{default:a((()=>[o("|")])),_:1}),t(f,{class:"link-highlight",onClick:U},{default:a((()=>[o("注册新账号")])),_:1})],64))])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-31acd87f"]]);export{w as default};
