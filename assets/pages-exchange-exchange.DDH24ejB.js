import{r as a,f as e,c as s,w as l,i as t,o,a as c,h as r,j as u,F as i,b as n,k as d,l as g,B as f,m,x as p,e as _,n as v,t as h,d as x}from"./index-CuaaJPDA.js";import{o as y}from"./uni-app.es.l4NMnEKD.js";import{r as k}from"./request.CEomxEkn.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=""+new URL("avatar-CeFaMklH.png",import.meta.url).href,C=b({__name:"exchange",setup(b){const C=["全部","书籍","数码","生活","乐器","运动"],j=a("全部"),F=a([]);y((()=>{(async()=>{try{const a=await k({url:"/exchange/list?type=exchange",hideErrorToast:!0});a.data&&(F.value=a.data.map((a=>({id:a.id,title:a.title,want:"goods"===a.exchangeMode?a.targetItem:`${a.price} 积分`,user:"匿名同学",img:a.img,category:a.category}))))}catch(a){}})()}));const I=e((()=>"全部"===j.value?F.value:F.value.filter((a=>a.category.includes(j.value)||j.value===a.category)))),M=()=>{if(!g("token"))return f({title:"请先登录",icon:"none"}),void setTimeout((()=>{m({url:"/pages/login/login"})}),1e3);m({url:"/pages/exchange/publish"})};return(a,e)=>{const g=t,f=p,y=x,k=_;return o(),s(g,{class:"page"},{default:l((()=>[c(f,{"scroll-x":"",class:"header-filter-scroll","show-scrollbar":!1},{default:l((()=>[c(g,{class:"header-filter"},{default:l((()=>[(o(),r(i,null,u(C,((a,e)=>c(g,{class:v(["tag",{active:j.value===a}]),key:e,onClick:e=>(a=>{j.value=a})(a)},{default:l((()=>[n(h(a),1)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),c(g,{class:"goods-list"},{default:l((()=>[(o(!0),r(i,null,u(I.value,((a,e)=>(o(),s(g,{class:"goods-item",key:e,onClick:e=>{return s=a.id,void m({url:`/pages/exchange-detail/exchange-detail?id=${s}`});var s}},{default:l((()=>[c(g,{class:"img-box"},{default:l((()=>[c(y,{src:a.img,mode:"aspectFill",class:"goods-img"},null,8,["src"]),c(g,{class:"eco-badge"},{default:l((()=>[n("♻️ "+h(a.category),1)])),_:2},1024)])),_:2},1024),c(g,{class:"goods-info"},{default:l((()=>[c(g,{class:"goods-title"},{default:l((()=>[n(h(a.title),1)])),_:2},1024),c(g,{class:"goods-exchange"},{default:l((()=>[c(k,{class:"label"},{default:l((()=>[n("想换：")])),_:1}),c(k,{class:"value"},{default:l((()=>[n(h(a.want),1)])),_:2},1024)])),_:2},1024),c(g,{class:"user-info"},{default:l((()=>[c(y,{src:w,class:"avatar-small"}),c(k,{class:"username"},{default:l((()=>[n(h(a.user),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===I.value.length?(o(),s(g,{key:0,class:"empty-tip"},{default:l((()=>[c(k,null,{default:l((()=>[n("暂无该分类物品")])),_:1})])),_:1})):d("",!0)])),_:1}),c(g,{class:"fab-btn",onClick:M},{default:l((()=>[n("+")])),_:1})])),_:1})}}},[["__scopeId","data-v-c866bc87"]]);export{C as default};
